{
    "embedded" : false,
    "maxConnectionAttempts" : 5,
    "security" : {
        "trustManager" : "file",
        "fileBasedTrustManagerType" : "JKS",
        "fileBasedTrustManagerFile" : "&{idm.install.dir}/security/truststore",
        "fileBasedTrustManagerPasswordFile" : "&{idm.install.dir}/security/storepass"
    },
    "ldapConnectionFactories" : {
        "bind" : {
            "connectionSecurity" : "starttls",
            "connectionPoolSize" : 50,
            "heartBeatIntervalSeconds" : 60,
            "heartBeatTimeoutMilliSeconds" : 10000,
            "primaryLdapServers" : [
                {
                    "hostname" : "{{ ds_idrepo_server }}",
                    "port" : {{ ds_idrepo_server_ldap_port }}
                }
            ],
            "secondaryLdapServers" : [
                {
                    "hostname" : "{{ ds_idrepo_server }}",
                    "port" : {{ ds_idrepo_server_ldap_port }}
                }
            ]
        },
        "root" : {
            "inheritFrom" : "bind",
            "authentication" : {
                "simple" : {
                    "bindDn" : "{{ ds_admin_dn }}",
                    "bindPassword" : "{{ ldap_bind_password }}"
                    }
                }
        }
    },
    "queries" : {
        "generic" : {
            "query-all-ids" : {
                "_queryFilter" : "true",
                "_fields" : "_id,_rev"
            },
            "credential-query" : {
                "_queryFilter" : "/userName eq \"${username}\""
            },
            "credential-internaluser-query" : {
                "_queryFilter" : "/_id eq \"${username}\""
            },
            "get-by-field-value" : {
                "_queryFilter" : "/${field} eq \"${value}\""
            },
            "for-userName" : {
                "_queryFilter" : "/userName eq \"${uid}\""
            },
            "query-all" : {
                "_queryFilter" : "true"
            },
            "links-for-firstId" : {
                "_queryFilter" : "/linkType eq \"${linkType}\" AND /firstId = \"${firstId}\""
            },
            "links-for-linkType" : {
                "_queryFilter" : "/linkType eq \"${linkType}\""
            },
            "get-recons" : {
                "_queryFilter" : "/entryType eq \"summary\"",
                "_fields" : "reconId,mapping,activitydate",
                "_sortKeys" : "-activitydate"
            },
            "get-notifications-for-user" : {
                "_queryFilter" : "/receiverId eq \"${userId}\"",
                "_sortKeys" : "-createDate"
            },
            "query-cluster-failed-instances" : {
                "_queryFilter" : "/timestamp le ${timestamp} and (/state eq \"1\" or /state eq \"2\")"
            },
            "query-cluster-running-instances" : {
                "_queryFilter" : "/state eq 1"
            },
            "query-cluster-instances" : {
                "_queryFilter" : "true"
            },
            "query-cluster-events" : {
                "_queryFilter" : "/instanceId eq \"${instanceId}\""
            },
            "find-relationships-for-resource" : {
                "_queryFilter" : "(/firstResourceCollection eq \"${resourceCollection}\" and /firstResourceId eq \"${resourceId}\" and /firstPropertyName eq \"${propertyName}\") or (/secondResourceCollection eq \"${resourceCollection}\" and /secondResourceId eq \"${resourceId}\" and /secondPropertyName eq \"${propertyName}\")"
            },
            "find-relationship-edges" : {
                "_queryFilter" : "((/firstResourceCollection eq \"${firstResourceCollection}\" and /firstResourceId eq \"${firstResourceId}\" and /firstPropertyName eq \"${firstPropertyName}\") and (/secondResourceCollection eq \"${secondResourceCollection}\" and /secondResourceId eq \"${secondResourceId}\" and /secondPropertyName eq \"${secondPropertyName}\")) or ((/firstResourceCollection eq \"${secondResourceCollection}\" and /firstResourceId eq \"${secondResourceId}\" and /firstPropertyName eq \"${secondPropertyName}\") and (/secondResourceCollection eq \"${firstResourceCollection}\" and /secondResourceId eq \"${firstResourceId}\" and /secondPropertyName eq \"${firstPropertyName}\"))"
            }
        },
        "explicit" : {
            "query-all-ids" : {
                "_queryFilter" : "true",
                "_fields" : "_id,_rev"
            },
            "credential-query" : {
                "_queryFilter" : "/userName eq \"${username}\""
            },
            "credential-internaluser-query" : {
                "_queryFilter" : "/_id eq \"${username}\""
            },
            "links-for-firstId" : {
                "_queryFilter" : "/linkType eq \"${linkType}\" AND /firstId = \"${firstId}\""
            },
            "links-for-linkType" : {
                "_queryFilter" : "/linkType eq \"${linkType}\""
            },
            "for-userName" : {
                "_queryFilter" : "/userName eq \"${uid}\""
            },
            "query-all" : {
                "_queryFilter" : "true"
            }
        }
    },
    "commands" : {
        "delete-mapping-links" : {
            "_queryFilter" : "/linkType eq \"${mapping}\"",
            "operation" : "DELETE"
        },
        "delete-target-ids-for-recon" : {
            "_queryFilter" : "/reconId eq \"${reconId}\"",
            "operation" : "DELETE"
        }
    },
    "rest2LdapOptions" : {
        "readOnUpdatePolicy" : "controls",
        "useSubtreeDelete" : false,
        "usePermissiveModify" : true,
        "useMvcc" : true,
        "mvccAttribute" : "etag"
    },
    "resourceMapping" : {
        "defaultMapping" : {
            "dnTemplate" : "ou=generic,dc=openidm,dc=forgerock,dc=com"
        },
        "explicitMapping" : {
            "internal/user" : {
                "dnTemplate" : "ou=users,ou=internal,dc=openidm,dc=forgerock,dc=com",
                "objectClasses" : [
                    "uidObject",
                    "fr-idm-internal-user"
                ],
                "properties" : {
                    "_id" : {
                        "type" : "simple",
                        "ldapAttribute" : "uid",
                        "isRequired" : true,
                        "writability" : "createOnly"
                    },
                    "password" : {
                        "type" : "json",
                        "ldapAttribute" : "fr-idm-password"
                    }
                }
            },
            "managed/user" : {
                "dnTemplate" : "ou=people,{{ ds_idrepo_dn }}",
                "namingStrategy" : {
                    "type" : "clientDnNaming",
                    "dnAttribute" : "fr-idm-uuid"
                },
                "nativeId" : false,
                "objectClasses" : [
                    "person",
                    "organizationalPerson",
                    "inetOrgPerson",
                    "iplanet-am-user-service",
                    "devicePrintProfilesContainer",
                    "kbaInfoContainer",
                    "fr-idm-managed-user-explicit",
                    "forgerock-am-dashboard-service",
                    "inetuser",
                    "iplanet-am-auth-configuration-service",
                    "iplanet-am-managed-person",
                    "iPlanetPreferences",
                    "oathDeviceProfilesContainer",
                    "pushDeviceProfilesContainer",
                    "sunAMAuthAccountLockout",
                    "sunFMSAML2NameIdentifier",
                    "webauthnDeviceProfilesContainer"
                ],
                "properties" : {
                    "_id" : {
                        "primaryKey" : true,
                        "type" : "simple",
                        "ldapAttribute" : "fr-idm-uuid"
                    },
                    "userName" : {
                        "type" : "simple",
                        "ldapAttribute" : "uid"
                    }
                }
            }
        },
        "genericMapping" : {
            "config" : {
                "dnTemplate" : "ou=config,dc=openidm,dc=forgerock,dc=com"
            },
            "managed/*" : {
                "dnTemplate" : "ou=managed,dc=openidm,dc=forgerock,dc=com"
            }
        }
    }
}

